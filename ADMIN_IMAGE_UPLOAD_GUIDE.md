# 📋 מדריך התקנה - מערכת ניהול מנהל + העלאת תמונות

## 🎯 סקירה כללית
מסמך זה מפרט את כל השינויים שבוצעו בשרת .NET כדי להפעיל את מערכת ניהול המנהל עם יכולות העלאת תמונות למוצרים, קטגוריות וסגנונות.

---

## ✅ מה נוסף לפרויקט?

### 📁 תיקיות חדשות
נוצרו התיקיות הבאות:
```
wwwroot/
  └── uploads/
      ├── products/      ← תמונות מוצרים
      ├── categories/    ← תמונות קטגוריות
      └── styles/        ← תמונות סגנונות
```

### 🔧 שינויים בקבצים

#### 1️⃣ Program.cs
**מה נוסף:** הערה ליד `app.UseStaticFiles();`
```csharp
// ===== נוסף עבור העלאת תמונות למנהל - מאפשר גישה לקבצים סטטיים =====
app.UseStaticFiles();
```

#### 2️⃣ ProductController.cs
**מה נוסף:** endpoint חדש `[HttpPost("upload")]`
- מאפשר העלאת 2 תמונות (קדמית ואחורית) למוצר
- כולל אימות מנהל
- שומר תמונות ב-`wwwroot/uploads/products/`
- מסומן בהערות: `// ===== נוסף עבור העלאת תמונות למנהל - התחלה =====`

#### 3️⃣ CategoryController.cs
**מה נוסף:** endpoint חדש `[HttpPost("upload")]`
- מאפשר העלאת תמונה אחת לקטגוריה
- כולל אימות מנהל
- שומר תמונות ב-`wwwroot/uploads/categories/`
- מסומן בהערות: `// ===== נוסף עבור העלאת תמונות למנהל - התחלה =====`

#### 4️⃣ StyleController.cs
**מה נוסף:** endpoint חדש `[HttpPost("upload")]`
- מאפשר העלאת תמונה אחת לסגנון
- כולל אימות מנהל
- שומר תמונות ב-`wwwroot/uploads/styles/`
- מסומן בהערות: `// ===== נוסף עבור העלאת תמונות למנהל - התחלה =====`

---

## 🔍 איך למצוא את הקוד שנוסף?

כל הקוד שנוסף מסומן בהערות ברורות:
```csharp
// ===== נוסף עבור העלאת תמונות למנהל - התחלה =====
... קוד ...
// ===== נוסף עבור העלאת תמונות למנהל - סוף =====
```

חפשי את המילים "נוסף עבור העלאת תמונות למנהל" בקבצים הבאים:
- `project1/Program.cs`
- `project1/Controllers/ProductController.cs`
- `project1/Controllers/CategoryController.cs`
- `project1/Controllers/StyleController.cs`

---

## 🗑️ איך למחוק את הכל?

אם את רוצה למחוק את כל התוספות:

### שלב 1: מחיקת תיקיות
מחקי את התיקייה:
```
wwwroot/uploads/
```

### שלב 2: מחיקת קוד מ-Controllers
במחק את כל הקוד בין ההערות:
```csharp
// ===== נוסף עבור העלאת תמונות למנהל - התחלה =====
...
// ===== נוסף עבור העלאת תמונות למנהל - סוף =====
```

מהקבצים:
- ProductController.cs
- CategoryController.cs
- StyleController.cs

### שלב 3: מחיקת הערה מ-Program.cs
מחקי את השורה:
```csharp
// ===== נוסף עבור העלאת תמונות למנהל - מאפשר גישה לקבצים סטטיים =====
```

**שימי לב:** השאירי את השורה `app.UseStaticFiles();` - היא חשובה גם לדברים אחרים!

---

## 📊 סיכום טכני

| רכיב | מה נוסף | מטרה |
|------|---------|------|
| **ProductController** | [HttpPost("upload")] | העלאת 2 תמונות למוצר |
| **CategoryController** | [HttpPost("upload")] | העלאת תמונה לקטגוריה |
| **StyleController** | [HttpPost("upload")] | העלאת תמונה לסגנון |
| **Program.cs** | הערה ליד UseStaticFiles | הבהרה למה זה קיים |
| **wwwroot/uploads/** | תיקיות products, categories, styles | אחסון תמונות |

---

## 🔐 אימות מנהל

כל ה-endpoints החדשים מקבלים אימות דרך Headers:
- `userId` - מזהה המשתמש
- `password` - סיסמת המשתמש

הקוד בודק:
```csharp
bool isAdmin = await _userService.IsAdminById(userId, password);
if (!isAdmin)
    return StatusCode(403, new { message = "אין הרשאות מנהל" });
```

---

## 🧪 בדיקת תקינות

### בדיקה 1: העלאת תמונה למוצר
1. התחברי כמנהל באפליקציה
2. עברי לעמוד Admin
3. בחרי תמונה קדמית ואחורית
4. מלאי את שאר השדות
5. לחצי "הוסף מוצר"
6. ✅ אמור להופיע: "המוצר נוסף בהצלחה!"
7. ✅ התמונות נשמרו ב-`wwwroot/uploads/products/`

### בדיקה 2: העלאת תמונה לקטגוריה
1. עברי לטאב "קטגוריות"
2. בחרי תמונה
3. מלאי שם ותיאור
4. לחצי "הוסף קטגוריה"
5. ✅ אמור להופיע: "הקטגוריה נוספה בהצלחה!"

### בדיקה 3: העלאת תמונה לסגנון
1. עברי לטאב "סגנונות"
2. בחרי תמונה
3. מלאי שם ותיאור
4. לחצי "הוסף סגנון"
5. ✅ אמור להופיע: "הסגנון נוסף בהצלחה!"

---

## 🐛 פתרון בעיות נפוצות

### שגיאה 403 - "אין הרשאות מנהל"
**פתרון:** ודאי שהמשתמש מחובר כמנהל ושהסיסמה נשמרת ב-localStorage.

### שגיאה 404 - "Endpoint לא נמצא"
**פתרון:** ודאי שהוספת את ה-endpoint `[HttpPost("upload")]` ל-Controller המתאים.

### שגיאה 500 - "שגיאה פנימית"
**פתרון:** בדקי את הלוגים של השרת. בדרך כלל זה בעיה בשם DTO או בהזרקת dependencies.

### התמונות לא מוצגות
**פתרון:** ודאי ש-`app.UseStaticFiles();` קיים ב-Program.cs.

---

## 🎉 סיום

לאחר ביצוע כל השלבים, המערכת תומכת ב:
- ✅ העלאת תמונות למוצרים (2 תמונות)
- ✅ העלאת תמונות לקטגוריות
- ✅ העלאת תמונות לסגנונות
- ✅ מחיקת מוצרים/קטגוריות/סגנונות עם אימות מנהל
- ✅ הודעות הצלחה/שגיאה למשתמש
- ✅ אבטחה מלאה - רק מנהלים יכולים להעלות/למחוק

---

**נוצר עבור:** חברה מסודרת 💼  
**תאריך:** 25/02/2026  
**גרסה:** 1.0  

**בהצלחה! 🚀**
